# 함수형 길들이기
> 객체지향은 가동부를 캡슐화하여 코드의 이해를 돕는다. 함수형 프로그래밍은 가동부를 최소화하여 코드의 이해를 돕니다(마이클 페더스)

## 함수형 프로그래밍이 필요한 이유

- 웹 생태계는 복잡해졌고, 다루어야할 데이터의 양도 늘어났다
- 자바스크립트에서도 데이터 및 데이터를 다루는 함수에 대해 진지하게 고민하는 프로그래밍 패라다임이 필요하다

---

### 고민해봐야할 설계요소

- 확장성: 추가 기능을 지원하기 위해 계속 코드를 리팩터링 해야 하는가?
- 모듈화 가능성: 파일 하나를 고치면 다른 ㅍ파일도 영향을 받는가?
- 재사용성: 중복이 많은가?
- 테스트성: 함수를 단위 테스트하기 어려운가?
- 헤아리기 쉬움: 체계도 없고 따라가기 어려운 코드인가?

---

- 위 요소에서 한가지라도 YES라면 함수형프로그래밍이 필요할 것이다
- 함수형 프로그래밍은 문제를 바라보는 방식에 대한 것이다(함수형 사고)

## 함수형 프로그래밍은 유용한가?

- 자바스크립트 맥락에서보면 함수형 프로그래밍 사고방식은 자바스크립트만의 매우 표현적인 특성을 가다듬어준다
- 깔끔하면서, 모듈적이고, 테스트하기 좋고, 간결한 코드 작성에 도움을 준다
- 자바스크립트는 상태관리는 개발자에게 부담하는 동적인 플랫폼이다
- 코드베이스가 커지면 점점 다루기 어려워지는데, 함수형 프로그래밍은 상태관리의 어려움을 줄여주는 역할을 한다

### Q. 자바스크립트 상태관리란
### Q. 동적인 플랫폼이란

## 함수형 프로그래밍이란

- 한마디로 함수 사용을 강조하는 소프트웨어 개발 스타일
- 문제를 조금 다른 사고방식으로 접근한다
- 진정한 목표는 애플리케이션의 **부수효과를 방지**하고 **상태변이를 감소**하기 위해 **데이터의 제어 흐름과 연산을 추상**하는 것이다.
- 특정 도구가 이니다. 하나의 코드 작성 방법이다.
- 프로그램을 이해하기 쉬운 **작은 단위로 나누고** 전체적으로 헤아리기 쉬운 형태로 **다시 조합**하는 과정이다.
- 함수형 프로그래밍 이면에 깔려있는 기본개념은 아래와 같다
  - 선언적 프로그래밍
  - 순수함수
  - 참조 투명성
  - 불변성

### 함수형 프로그래밍 기본개념

### 선언적

- 함수형 프로그래밍은 선언적 프로그래밍 패러다임에 속한다
- 선언적의 반대말처럼 쓰이는 개념은 명령형 혹은 절차형 모델이 있다.
- 명령형 프로그래밍은 `어떻게`작업을 처리해야하는지 상세하게 지시한다
- 선언형 프로그래밍은 `서술부`와 `평가부`를 분리하여 제어 흐름이나 상태변화를 특정하지 않고도 프로그램 로직이 무엇인지 `표현식`으로 나타낸다.
- `내부 매커니즘은 추상화`한 상태에서 그 결과가 어떻게 나와야 하는지를 구문으로 서술한다.
- 함수로 추상화할 경우 코드의 재사용성이 좋아진다.

### 순수함수와 부수효과

- 함수형 프로그래밍은 순수함수로 구성된 불변 프로그램 구축을 전제로 한다.
- 순수함수의 특징은 아래와 같다
  - **주어진 입력에만 의존한다.**
  - 평가 도중 또는 호출 간 변경될 수 있는 숨겨진 값이나 외부 상태와 무관하게 작동한다
  - 전역 객체나 레퍼런스로 전달된 매개변수를 수정하거나, 함수 스코프 밖에서 어떠한 변경도 일으키지 않는다.
- 쉽게 생각하자. 본인이 받은 값을, 본인의 스코프에서만 처리한다는 개념정도로 이해해보자
- 위 조건이 성립하지 않으면 순수함수라고 하지 않고, 대체로 부수효과를 발생시킨다
  - 전역 범위에서 변수, 속성, 자료구조를 변경
  - 함수의 원래 인수 값을 변경
  - 사용자 입력을 처리
  - 예외를 일으킨 해당 함수가 붙잡지 않고 그대로 예외를 던짐
  - 화면 또는 로그 파일에 출력
  - HTML 문서, 브라우저 쿠키, DB에 질의
- 하지만, 오해하지 말아야할것은 함수형 프로그래밍은 모든 상태변이를 근절하자는 것이 아니다.
- 상태변이를 줄이고, 관리할 수 있는 프레임워크를 제공하여 순수/불순 함수를 구분하자는 것이다.
- 부수 효과를 줄일수록, 외부 조건 변화에 덜 취약한 프로그램이 된다.

### 참조 투명성과 치환성

- 참조투명성하다는 것은 순수성을 만족시킨 다는 말이다.
- 순수성이란 **함수의 인수와 결과값 사이의 순수한 매핑 관계**를 의미한다.
- 쉽게 생각하면, 함수가 일관된 반환값을 보장하도록 해야 한다는 것이다.
- 일관된 반환값을 보장할수록 예측 가능한 프로그래밍이 가능해지고, 전체 로직 파악도 쉬워진다.

### 불변성

- 불변 데이터는 생성된 후에 바뀌지 않는다
- 자바스크립트 배열은 레퍼런스 타입으로 불변이 아니다.
- 때문에 함수 인수로 전달받을 경우 원본을 변경시켜 부수효과를 발생시킬 가능성이 있다.

---

- 위 4가지 특징을 조합해서 함수형 프로그래밍의 정의를 내리면 다음과 같다

> 함수형 프로그래밍은 외부에서 관찰가능한 부수효과가 제거된 불변 프로그램을 작성하기 위해 순수함수를 선언적으로 평가하는 것이다.

- 함수를 단순히 연산하는 기능으로만 바라보지 말자.
- 함수를 순수 연산의 관점에서 **데이터를 변경하지 않는 고정된 작업단위**로 바라본다면 잠재적인 버그를 줄일 수 있다.
- 함수형 프로그래밍은 코드의 복잡성을 극복하는데 도움을 줄 것이다

## 함수형 프로그래밍의 좋은 점

- 함수형 프로그래밍의 장점을 극대화하려면 **함수형으로 생각하며 적절한 도구를 구사**할 줄 알아야 한다.

### 복잡한 작업을 단순하게 분해

- 함수형 프로그래밍은 고수준에서보면 사실상 **분해와 합성**간의 상호작용이라고 할 수 있다.
- 프로그램을 작은 단위로 쪼개고, 쪼갠 단위롤 다시 합쳐서 프로그램을 만들어 간다
- 함수형 프로그래밍의 **작업 단위는 함수** 그 자신이다.
- 함수는 저마다 한가지 목표만 바라봐야 하는데, 이러한 원리를 단일성의 원리라고 한다

### 이해하기 쉬운 데이터 처리

- 함수형 프로그래밍 라이브러리들은 만들어진 함수를 조합하는 기능을 가지고 있다.
- 작은 작업단위 조합해서 프로그래밍하면, 그 작업단위들의 조합을 보기만해도 어떤 작업을 하는지 쉽게 파악이 가능하다.

### 비동기 데이터 처리(리액티브 프로그래밍)

- 더 높은 수준으로 코드를 추상화하여 비동기, 이벤트 기반 프로그램을 설정하느라 반복되는 코드를 줄일 수 있다
- 비즈니스 로직에만 더 집중할 수 있다.
- 함수를 체인으로 묶고 합성하는 함수형 프로그래밍의 특징을 최대한 사용 가능하다.
- 리액티브 프로그래밍에서는 옵저버블이라는 장치를 통해 데이터 흐름을 구독해서 원하는 연산을 합성 및 체이닝하여 처리한다.

### Q. 리액티브 프로그래밍이란?

## 정리 및 생각

- 핵심은 문제를 함수형으로 바라봐야 한다.
- 그 과정에서 함수는 선언적이고, 부수효과없고, 참조투명하며, 불변성을 유지하는 함수를 만들어야 한다
- 위 조건을 만족시키는 프로그래밍을 하면, 전체 로직을 이해하기 쉬운 프로그램을 만들 수 있다.
- 순수함수를 만들기 위하 노력은 결국, 작은 단위로 함수를 쪼개게 만들것이다.
- 작은 단위로 쪼개진 함수는 단일성 원리를 따를 가능성이 커진다. 
- 단일성의 원리를 따르는 함수라면, 재사용성이 커질 것이다. 그 이유는 그 함수의 목표가 확실하기 때문이다.
- **그러니까, 어떤 프로그램을 만들 어떤 기능을 하는 함수를 만들지 고민해보자.**
- A라는 문제를 풀기 위해서는, 1,2,3이라는 함수들이 필요할거야. 함수를 만들며 로직을 고민해보도록 하자.